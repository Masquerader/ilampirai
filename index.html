<!DOCTYPE html>
<html>
<head>
	<title>ilampirai - Bridging noble & needy</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="icon" type="image/png" href="images/favicon1.png">
	<link rel="stylesheet" href="css/main.css">	
	<link href="http://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet" type="text/css">
	<link href="http://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet" type="text/css">
	<link href="css/prettyPhoto.css" rel="stylesheet" type="text/css">

	<link href="css/icon.css" rel="stylesheet" type="text/css">
	<script src='http://code.jquery.com/jquery-1.9.1.js'></script>
	<script src="js/jquery.prettyPhoto.js" type="text/javascript"></script>
	
</head>
<body>
	<div id="loading" style="position:absolute;top:50%;left:50%;z-index:9999;"><img src="images/45.gif"/></div>
	<div id="header">	
		<div id="navbar">
			<div id="logo"></div> 
			<ul>
				<li class="home selected"><a href="#">Home</a></li>
				<li class="about"><a href="#">About Us</a></li>
				<li class="project"><a href="#" style="background-image:none;">Projects</a></li>
				<li class="hspace"></li>
				<li class="gallery"><a href="#">Gallery</a></li>
				<li class="team"><a href="#">Team</a></li>
				<li class="contact" style="background-image:none;"><a href="#">Contact Us</a></li>
			</ul>
			
		</div>
		
	</div> 
	<div id="main">
		<div id="slides">
    		<!-- <img src="images/IMG_1.jpg" style="display:block;"/>
    		<img src="images/IMG_2.jpg"/>
    		<img src="images/IMG_3.jpg"/>
    		<img src="images/IMG_4.jpg"/> -->
    		<img src="https://m.ak.fbcdn.net/sphotos-g.ak/hphotos-ak-prn2/1557366_693556257351756_1958874898_o.jpg" style="display:block;"/>
    		<img src="https://m.ak.fbcdn.net/sphotos-g.ak/hphotos-ak-ash2/t1/197502_195146347192752_7620326_n.jpg"/>
    		<img src="https://m.ak.fbcdn.net/sphotos-a.ak/hphotos-ak-frc1/385170_297363436971042_956429475_n.jpg"/>
    		<img src="https://m.ak.fbcdn.net/sphotos-e.ak/hphotos-ak-ash2/t1/374248_297349896972396_186183961_n.jpg"/>
    		<p>This is heading -1</p>
    		<div id="description">Description  Description  Description  Description  Description  Description  Description 1</div> 
  		</div>
	</div>
	<div id="footer">
			Copyrights Â© 2013 ilampirai.org. All rights reserved.
		</div>
	<script type="text/javascript">
	var caption = ['This is heading 1','This is heading -2','This is heading -3','This is heading -4'];
	var description = ['Description 1 Description 1 Description 1 Description 1 Description 1 Description 1 Description 1 ',
						'Description 2 Description 2 Description 2 Description 2 Description 2 Description 2 Description 2 ',
						'Description 3 Description 3 Description 3 Description 3 Description 3 Description 3 Description 3 ',
						'Description 4 Description 4 Description 4 Description 4 Description 4 Description 4 Description 4 '];
	var animInterval;
	$(window).load(function(){
		$("#loading").fadeOut('slow');
	})
	$(document).ready(function(){
		slider();
	});
	function slider(){

			var images=$("#slides").children();	
			i=0;

			function run(){			
				$("#description").fadeOut(1000,function(){
					$("#slides p").fadeOut(1000,function(){
						$(images[i]).fadeOut(2000);
						i++;
						if(i==4){i=0;}
						$(images[i]).fadeIn(2000,function(){
							$("#slides p").text(caption[i]).fadeIn(1000,function(){
								$("#description").text(description[i]).fadeIn(1000);
							});
						});	
					});
				});
				animInterval=setTimeout(run,8500);	
			}
			setTimeout(run,3000);
		}

	$("#navbar li").click(function(){
		$("#loading").fadeIn('slow');
		clearTimeout(animInterval);
		$("#navbar li").removeClass("selected");
		var requested = $(this).attr('class');
		$(this).addClass("selected");
		if(requested == "home")
		{
			$("#main").html('<div id="slides"><img src="https://m.ak.fbcdn.net/sphotos-g.ak/hphotos-ak-prn2/1557366_693556257351756_1958874898_o.jpg" style="display:block;"/><img src="https://m.ak.fbcdn.net/sphotos-g.ak/hphotos-ak-ash2/t1/197502_195146347192752_7620326_n.jpg"/><img src="https://m.ak.fbcdn.net/sphotos-a.ak/hphotos-ak-frc1/385170_297363436971042_956429475_n.jpg"/><img src="https://m.ak.fbcdn.net/sphotos-e.ak/hphotos-ak-ash2/t1/374248_297349896972396_186183961_n.jpg"/><p>This is heading -1</p><div id="description">Description  Description  Description  Description  Description  Description  Description 1</div></div>');
			$("#loading").fadeOut('slow');
			slider();
		}
		else if(requested == "project")
		{
			getPosts(0);
		}
		else{
			$.ajax({
  				url: "server.php",
  				type: "GET",
  				data: { page : requested }
			}).done(function( html ) {
  				$("#main").html( html );
  				$("#loading").fadeOut('slow');
			});
		}
});
	function getPosts(offst){
			var nextPage = offst;
			var html='';
			var month = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
			var url = "http://api.tumblr.com/v2/blog/yahoo.tumblr.com/posts?api_key=z85MlZeqU5upp7onUGeAMvHHfYwzRv9DJJqK57eV0yQqjmhD09&limit=5&callback=?&offset="+nextPage;
			var postsPerPage=5;
			$.getJSON(url, function(results){
        		var posts= results.response.posts;
        		var totalPosts = parseInt(results.response.total_posts);
        		var pagination = '';
        		for(i=0;i<posts.length;i++)
        		{
          		 	var dates = posts[i].date.split(" ");
            		var dateSplit = dates[0].split("-");
            		d = new Date(dateSplit[0] + " " + dateSplit[1] + ", " + dateSplit[2]);
           			html = html + '<li><div class="timestamp"><div class="day">'+ d.getDate() +'</div><div class="month">'+ month[d.getMonth()]+'</div><div class="year">'+ d.getFullYear() + '</div></div><div class="title">'+ posts[i].title+
           			'</div><div class="post">'+ posts[i].body + '</div></li>';
        		}
        		
        		if( nextPage == 0){
        			var pages = parseInt(totalPosts/postsPerPage);
        			var lastPage = totalPosts%postsPerPage;
        			if(lastPage!=0){pages++;}
        				for(i=1;i<=pages;i++){
        					var offset = (i-1)*5;
        					if(i==1)
        					{
        						pagination = pagination + '<a href="#" class="first active" offset=' + offset + '>' + i + '</a>';
        					}
        					else if(i==pages)
        					{
        						pagination = pagination + '<a href="#" class="last" offset=' + offset + '>' + i + '</a>';	
        					}
        					else
        					pagination = pagination + '<a href="#" class="" offset=' + offset + '>' + i + '</a>';
        				}
        			pagination = '<div id="pagination"><a href="#" class="prev" style="display:none;">prev</a>' + pagination + '<a href="#" class="next" offset="5">next</a></div>';
        			js = '<script>$("#pagination a").click(function(){$("#pagination a").removeClass("active");var curOffset= parseInt($(this).attr("offset"));$(".prev").attr("offset",curOffset-5);$(".next").attr("offset",curOffset+5);$("#pagination a[offset=\'"+ curOffset + "\']").addClass("active");$(".prev").removeClass("active");$(".next").removeClass("active");if($(".active").attr("class").search("first")!=0){$(".prev").show();}if($(".active").attr("class").search("last")==0){$(".next").hide();}else{$(".next").show();};$("#loading").fadeIn("slow");getPosts(curOffset);});</'+ 'script>';
					html = '<ul id="posts">' + html + '</ul>' + pagination + js;
					$("#main").html( html );
					$("#loading").fadeOut('slow');
        		}
        		else{
        			$("#posts").html(html);
        			$("#loading").fadeOut('slow');
        		}
        		
        	});
		}
		function formSubmit(){
			console.log("Form submit");
		}
</script>
</body>
</html>